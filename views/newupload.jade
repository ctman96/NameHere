extends layout1
block title
  title Upload
block content

  head
    style.
      #title {position:relative; margin-top:300px;}
      #upload {position:relative; margin-top:10px;}

  h1#title= title

  form#upload(action="/upload", method="post", enctype="multipart/form-data")
    input(type="file", name="image")
    input(type="submit", value="Upload Image")
  br
  br
  br
  - if (images && images.length)

    - images.forEach(function(image){
      a(href=image.url)
        img(src=cloudinary.url(image.public_id + '.' + image.format, { width: 200, height: 200, crop: 'fill', version: image.version }))
    - })

block scripts
  script(type="text/javascript")
    // Configure Cloudinary
    $.cloudinary.config({ api_key: '!{api_key}', cloud_name: '!{cloud_name}' });

    $('.cloudinary-fileupload').bind('fileuploadstart', function(e){
    $('.preview').html('Upload started...');
    });

    // Upload finished
    $('.cloudinary-fileupload').bind('cloudinarydone', function(e, data){
    $('.preview').html(
    $.cloudinary.image(data.result.public_id, { format: data.result.format, version: data.result.version, crop: 'scale', width: 100, height: 100 })
    );
    return true;
    });
